-- SQL Script to Add Admin Role to User
-- Run this in Neon SQL Editor

-- Step 1: Check if ROLE_ADMIN exists, if not create it
INSERT INTO roles (name)
SELECT 'ROLE_ADMIN'
WHERE NOT EXISTS (
    SELECT 1 FROM roles WHERE name = 'ROLE_ADMIN'
);

-- Step 2: Find your user ID (replace 'your-email@example.com' with your actual email)
-- This query shows your user ID
SELECT id, email, full_name FROM users WHERE email = 'your-email@example.com';

-- Step 3: Add ROLE_ADMIN to your user
-- Replace 'your-email@example.com' with your actual email
INSERT INTO user_roles (user_id, role_id)
SELECT 
    u.id,
    r.id
FROM users u
CROSS JOIN roles r
WHERE u.email = 'your-email@example.com'
  AND r.name = 'ROLE_ADMIN'
  AND NOT EXISTS (
      SELECT 1 FROM user_roles ur 
      WHERE ur.user_id = u.id AND ur.role_id = r.id
  );

-- Step 4: Verify the role was added
SELECT 
    u.id,
    u.email,
    u.full_name,
    r.name as role
FROM users u
JOIN user_roles ur ON u.id = ur.user_id
JOIN roles r ON ur.role_id = r.id
WHERE u.email = 'your-email@example.com';

